window.addEventListener("load",()=>{const a=new URLSearchParams(window.location.search).get("code"),b=document.getElementById("email-form");b&&b.addEventListener("submit",async c=>{c.preventDefault(),c.stopImmediatePropagation();const d={name:"",password:"",c_password:""},e=b.querySelector(`input[name="name"]`);e&&(d.name=e.value.trim());const f=b.querySelector(`input[name="Password"]`);f&&(d.password=f.value);const g=b.querySelector(`input[name="Password-2"]`);g&&(d.c_password=g.value);try{if(d.password&&d.password===d.c_password){const{name:b,password:c}=d,e=await fetch(`${baseUrl}/api/auth/activate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:b,password:c,auth_token:a}),credentials:"include"}),f=await e.json();if(f.status){localStorage.setItem("__user_data",JSON.stringify(f.data));const{hostname:a}=window.location;window.location.href=`https://${a}/dashboard`}else throw new Error(f.msg)}else throw new Error("Passwords don't match!")}catch(a){console.error(a),alert(a.message)}})});